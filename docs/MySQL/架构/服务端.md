# MySQL Server

![MySQL Server](/assets/images/MySQL结构.png)

### 连接器
```
mysql -h$ip -P$port -u$user -p
```

用户成功建立连接后，即使你用管理员账号对这个用户的权限做了修改，也不会影响已经存在连接的权限。

客户端如果太长时间没动静，连接器就会自动将它断开。这个时间是由参数 `wait_timeout` 控制的，默认值是8小时。


### 查询缓存
> MySQL 8.0 后移除。

执行过的语句及其结果会以 key-value 对的形式，被直接缓存在内存（Query Cache）中。如果命中则直接返回（当然在返回之前还得判断权限问题）。

有人说保留这个功能，有人说去除这个功能，还是看业务需要吧。静态表或者说长期不更新的表比较适合使用查询缓存。


### 分析器
解析器处理语法和解析查询, 生成一课对应的解析树；预处理器进一步检查解析树的合法。

- 词法分析，识别关键字、识别表名、列名等，注意拼写问题、引号等
- 语法分析，根据语法规则，判断你输入的这个 SQL 语句是否满足 MySQL 语法
- 语义分析，确保完整的SQL语句的通顺规范，判断表名，列名是否存在等。


### 优化器
析树转换成执行计划，并进行评估最优。决定使用哪个索引、决定各个表的连接顺序（join的时候谁做驱动表）。


### 执行器
判断执行语句的权限，执行语句。